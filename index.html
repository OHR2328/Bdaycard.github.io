<!doctype HTML>
<html>

<head>
    <title>Happy Birthday</title>
    <script src="https://aframe.io/releases/0.8.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/jeromeetienne/AR.js/1.5.0/aframe/build/aframe-ar.js"></script>
    <script src="https://unpkg.com/aframe-text-geometry-component/dist/aframe-text-geometry-component.min.js"></script>
    <script
        src="https://unpkg.com/aframe-particle-system-component@1.0.x/dist/aframe-particle-system-component.min.js"></script>
</head>

<body style="margin: 0px; overflow: hidden;">
    <a-scene embedded arjs="sourceType: webcam;">

        <a-assets>
            <a-asset-item id="cake-obj" src="/assets/cake.obj"></a-asset-item>
            <a-asset-item id="cake-mtl" src="/assets/cake.mtl"></a-asset-item>
            <a-asset-item id="BrightFuture-obj" src="/assets/tinker.obj"></a-asset-item>
            <a-asset-item id="BrightFuture-mtl" src="/assets/obj.mtl"></a-asset-item>
            <!-- <a-asset-item id="totoro-obj" src="/assets/"></a-asset-item>
            <a-asset-item id="totoro-mtl" src="/assets/Withwand.mtl"></a-asset-item> -->
            <audio id="bday" src="/assets/bday.mp3"></audio>
            <a-asset-item id="text-obj" src="/assets/3D_Happy_birthday.obj"></a-asset-item>
            <a-asset-item id="text-mtl" src="/assets/3D_Happy_birthday.mtl"></a-asset-item>

        </a-assets>

        <a-marker present="hiro">
            <a-obj-model src="#cake-obj" mtl="#cake-mtl" rotation="60 20 -155" scale="1 0.5 1"
                soundhandler></a-obj-model>
            <!-- <a-obj-model src="#totoro-obj" mtl="#totoro-mtl" rotation="90 180 0" scale="0.5 0.5 0.5"></a-obj-model> -->
            <a-entity rotation="-120 0 0">
                <!-- <a-entity geometry="primitive: plane; height: auto; width: auto" position="1 0.5 -3"
                    text="width: 4; value: This text will be 5 units wide."></a-entity> -->
                <a-entity obj-model="obj: #BrightFuture-obj; mtl : #BrightFuture-mtl" rotation="10 30 0"
                    position="-1.2 0.25 1" scale="0.01 0.01 0.01"></a-entity>
                <!-- <a-entity obj-model="obj: #totoro-obj; mtl:#totoro-mtl" rotation="-95 90 -95" scale="0.1 0.1 0.1"
                    position="1.3 -0.65 0.5"></a-entity> -->
                <a-entity obj-model="obj: #text-obj; mtl:#text-mtl" rotation="0 0 0" scale="0.5 0.5 0.5"
                    position="-1 0.5 -1">
                </a-entity>

            </a-entity>

            <a-entity rotation="-90 0 0">
                <a-entity position="-1 0.5 -1" particle-system="
                            preset: default; 
                            color: #f9e154; 
                            accelerationValue: 0, -10, 0; 
                            particleCount: 3000;
                            direction: -1;
                            rotationAxis: z;
                            rotation: -90, 0, 0">
                </a-entity>

                <a-entity position="1.5 0.5 -1" particle-system="
                preset: default; 
                color: #f9e154; 
                accelerationValue: 0, -10, 0; 
                particleCount: 3000;
                direction: -1;
                rotationAxis: z;
                rotation: -90, 0, 0">
                </a-entity>
        </a-marker>


        <a-entity sound="src: #bday" autoplay="false"></a-entity>
        <a-entity camera></a-entity>
    </a-scene>
    <script>
        AFRAME.registerComponent('soundhandler', {
            tick: function () {
                var entity = document.querySelector('[sound]');
                console.log(document.querySelector('a-marker').object3D['children'])
                if (document.querySelector('a-marker').object3D.visible == true) {
                    entity.components.sound.playSound();
                } else {
                    entity.components.sound.pauseSound();
                }

            }
        });
    </script>
</body>

</html>
